<!DOCTYPE html>
{% load static %}
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FindHome - Mon Dashboard</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="{% static 'css/dashboard_client.css' %}">
    <link rel="stylesheet" href="{% static 'css/messages.css' %}">

</head>
<body>
    <!-- Header -->
    <header id="header">
        <div class="container">
            <nav class="navbar">
                <a href="#" class="logo">
                    <i class="fas fa-home"></i>
                    LocalEasy
                </a>
                <ul class="nav-links">
                    <li><a href="{% url 'accueil' %}">Accueil</a></li>
                    <li><a href="{% url 'accueil' %}#properties">Propriétés</a></li>
                    <li><a href="{% url 'accueil' %}#services">Services</a></li>
                    <li><a href="{% url 'accueil' %}#contact">Contact</a></li>
                </ul>
                 {% if messages %}
            <div class="messages">
                {% for message in messages %}
                    <div class="alert alert-{{ message.tags }} auto-hide">
                        {{ message }}
                        <button class="alert-close" onclick="this.parentElement.remove()">×</button>
                    </div>
                {% endfor %}
            </div>
            {% endif %}
                <div class="nav-actions">
                    <div class="user-menu">
                        <div class="user-avatar">
                            <img src="https://randomuser.me/api/portraits/men/32.jpg" alt="Thomas Martin">
                        </div>
                        <span class="user-name">{{request.user.first_name}}</span>
                        <i class="fas fa-chevron-down"></i>
                        <div class="dropdown-menu">
                            <a href="#profile"><i class="fas fa-user"></i> Mon Profil</a>
                            <a href="#reservations"><i class="fas fa-calendar-check"></i> Mes Réservations</a>
                            <a href="#payments"><i class="fas fa-credit-card"></i> Paiements</a>
                            <a href="{% url 'deconnexion' %}"><i class="fas fa-sign-out-alt"></i> Déconnexion</a>
                        </div>
                    </div>
                    <button class="mobile-menu-btn">
                        <i class="fas fa-bars"></i>
                    </button>
                </div>
            </nav>
        </div>
    </header>

    <!-- Dashboard -->
    <div class="dashboard">
        <!-- Sidebar -->
        <div class="sidebar">
            <ul class="sidebar-menu">
                <li><a href="#overview" class="active"><i class="fas fa-tachometer-alt"></i> Tableau de bord</a></li>
                <li><a href="#profile"><i class="fas fa-user"></i> Mon Profil</a></li>
                <li><a href="#notifications"><i class="fas fa-bell"></i> Notifications</a></li>
            </ul>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Dashboard Overview -->
            <div id="overview" class="dashboard-section">
                <div class="dashboard-header">
                    <h1>Tableau de bord</h1>
                    <p>Bienvenue dans votre espace personnel, Thomas</p>
                </div>

                <!-- Dashboard Cards -->
                <div class="dashboard-cards">
                    <div class="card">
                        <div class="card-icon reservations">
                            <i class="fas fa-calendar-check"></i>
                        </div>
                        <h3>3</h3>
                        <p>Réservations actives</p>
                    </div>
                    <div class="card">
                        <div class="card-icon payments">
                            <i class="fas fa-credit-card"></i>
                        </div>
                        <h3>1 250€</h3>
                        <p>Dépenses ce mois-ci</p>
                    </div>
                    <div class="card">
                        <div class="card-icon favorites">
                            <i class="fas fa-heart"></i>
                        </div>
                        <h3>7</h3>
                        <p>Propriétés favorites</p>
                    </div>
                    <div class="card">
                        <div class="card-icon messages">
                            <i class="fas fa-envelope"></i>
                        </div>
                        <h3>2</h3>
                        <p>Nouveaux messages</p>
                    </div>
                </div>

                <!-- Recent Reservations -->
                <div class="section">
                    <div class="section-header">
                        <h2 class="section-title">Réservations récentes</h2>
                        <a href="#reservations" class="btn">Voir tout</a>
                    </div>
                    <div class="table-responsive">
                      <table>
    <thead>
        <tr>
            <th>Propriété</th>
            <th>Date de début</th>
            <th>Date de fin</th>
            <th>Prix</th>
            <th>Statut</th>
            <th>Actions</th>
        </tr>
    </thead>
    <tbody>
        {% for reservation in reservations %}
        <tr>
            <td>{{ reservation.property.title }}</td>
            <td>{{ reservation.check_in|date:"d/m/Y" }}</td>
            <td>{{ reservation.check_out|date:"d/m/Y" }}</td>
            <td>{{ reservation.property.price }}FCFA</td>
            <td>
                <span class="status {% if reservation.status == 'Confirmée' %}confirmed{% elif reservation.status == 'En attente' %}pending{% elif reservation.status == 'Terminée' %}cancelled{% endif %}">
                    {{ reservation.status }}
                </span>
            </td>
            <td>
                <button class="action-btn"><i class="fas fa-eye"></i></button>
                <button class="action-btn"><i class="fas fa-edit"></i></button>
            </td>
        </tr>
        {% empty %}
        <tr>
            <td colspan="6">Aucune réservation trouvée.</td>
        </tr>
        {% endfor %}
    </tbody>
</table>

                    </div>
                </div>

                <!-- Recent Payments -->
                <div class="section">
                    <div class="section-header">
                        <h2 class="section-title">Paiements récents</h2>
                        <a href="#payments" class="btn">Voir tout</a>
                    </div>
                    <div class="table-responsive">
                        <table>
                            <thead>
                                <tr>
                                    <th>Date</th>
                                    <th>Description</th>
                                    <th>Méthode</th>
                                    <th>Montant</th>
                                    <th>Statut</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>10/09/2023</td>
                                    <td>Appartement moderne centre-ville</td>
                                    <td>Carte de crédit</td>
                                    <td>750€</td>
                                    <td><span class="status confirmed">Payé</span></td>
                                </tr>
                                <tr>
                                    <td>25/08/2023</td>
                                    <td>Caution studio étudiant</td>
                                    <td>Virement</td>
                                    <td>550€</td>
                                    <td><span class="status confirmed">Remboursé</span></td>
                                </tr>
                                <tr>
                                    <td>15/07/2023</td>
                                    <td>Maison familiale spacieuse</td>
                                    <td>Carte de crédit</td>
                                    <td>600€</td>
                                    <td><span class="status pending">En attente</span></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Profile Section -->
            <div id="profile" class="dashboard-section" style="display: none;">
                <div class="dashboard-header">
                    <h1>Mon Profil</h1>
                    <p>Gérez vos informations personnelles</p>
                </div>

                <div class="section">
                    <div class="section-header">
                        <h2 class="section-title">Informations personnelles</h2>
                    </div>
                    
                    <div class="profile-picture">
                        <img src="https://randomuser.me/api/portraits/men/32.jpg" alt="Thomas Martin">
                        <div class="profile-picture-actions">
                            <button class="btn">Changer la photo</button>
                            <button class="btn btn-secondary">Supprimer</button>
                        </div>
                    </div>
                    
                   <form method="POST" class="profile-form" action="{% url 'manage_profile' %}">
                    {% csrf_token %}
                    <div class="form-group">
                        <label for="first-name">Prénom</label>
                        <input type="text" id="first-name" class="form-control" name="first-name" value="{{ user.first_name }}">
                    </div>
                    <div class="form-group">
                        <label for="last-name">Nom</label>
                        <input type="text" id="last-name" class="form-control" name="last-name" value="{{ user.last_name }}">
                    </div>
                    <div class="form-group">
                        <label for="email">Email</label>
                        <input type="email" id="email" class="form-control" name="email" value="{{ user.email }}">
                    </div>
                    <div class="form-group">
                        <label for="phone">Téléphone</label>
                        <input type="tel" id="phone" class="form-control" name="phone" value="{{ user.telephone }}">
                    </div>
                    <div class="form-group full-width">
                        <label for="address">Adresse</label>
                        <input type="text" id="address" class="form-control" name="address" value="{{ user.adresse }}">
                    </div>
                 
                    <div class="form-group full-width">
                        <button type="submit" class="btn">Enregistrer les modifications</button>
                    </div>
                </form>

                </div>

                <div class="section">
                    <div class="section-header">
                        <h2 class="section-title">Méthodes de paiement</h2>
                        <button class="btn">Ajouter une méthode</button>
                    </div>
                    
                    <div class="payment-methods">
                        <div class="payment-card default">
                            <div class="payment-card-header">
                                <div class="payment-type">
                                    <i class="fab fa-cc-visa"></i>
                                    <div>
                                        <h3>Carte Visa</h3>
                                        <p>**** **** **** 1234</p>
                                    </div>
                                </div>
                                <span class="default-badge">Par défaut</span>
                            </div>
                            <p>Expire le: 05/2025</p>
                            <div class="payment-actions">
                                <button class="action-btn"><i class="fas fa-edit"></i></button>
                                <button class="action-btn"><i class="fas fa-trash"></i></button>
                            </div>
                        </div>
                        
                        <div class="payment-card">
                            <div class="payment-card-header">
                                <div class="payment-type">
                                    <i class="fab fa-cc-mastercard"></i>
                                    <div>
                                        <h3>Carte Mastercard</h3>
                                        <p>**** **** **** 5678</p>
                                    </div>
                                </div>
                            </div>
                            <p>Expire le: 11/2024</p>
                            <div class="payment-actions">
                                <button class="action-btn"><i class="fas fa-edit"></i></button>
                                <button class="action-btn"><i class="fas fa-trash"></i></button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="{% static 'js/dashboard_client.js' %}">
      
    </script>
</body>
</html>